import{r,k as D,j as e,c as N}from"./index-BkFRGIjD.js";import{d as o,H as k,D as v}from"./index-DyNBUTRF.js";import{_ as j,S as b}from"./index-Ce7Rww7O.js";import"./attach-properties-to-component-CxYBDbn1.js";import"./use-props-value-8KDK95xI.js";const I=()=>{const[x,c]=r.useState(!1),[l,f]=r.useState(()=>o(new Date).format("YYYY")),{billList:y}=D(s=>s.bill),[n,m]=r.useState([]),h=()=>{c(!0)},i=r.useMemo(()=>j.groupBy(y,s=>o(s.date).format("YYYY")),[y]),d=r.useMemo(()=>{const s=n.filter(a=>a.type==="pay").reduce((a,u)=>a+u.money,0),t=n.filter(a=>a.type==="income").reduce((a,u)=>a+u.money,0);return{pay:s,income:t,total:s+t}},[l,n]),p=r.useMemo(()=>{const s=j.groupBy(n,a=>o(a.date).format("YYYY-MM")),t=Object.keys(s);return{groupMonth:s,keys:t}},[l,n]),Y=s=>{const t=o(s).format("YYYY");f(t),i[t]?m(i[t]):m([]),c(!1)};return r.useEffect(()=>{i[l]&&m(i[l])},[i]),e.jsxs("div",{className:"yearBill",children:[e.jsx(k,{title:"年度账单",backArrow:!0}),e.jsxs("div",{className:"yearContent",children:[e.jsxs("div",{className:"yearBillTitle",children:[e.jsxs("span",{children:[l,"年度账单"]}),e.jsx("div",{className:"billIconWrap",children:e.jsx("span",{className:N("billIcon",x&&"expand"),onClick:h})})]}),e.jsxs("div",{className:"yearBillDetail",children:[e.jsxs("div",{className:"yearBillDetailItem",children:[e.jsx("span",{children:d.pay}),e.jsx("span",{children:"支出"})]}),e.jsxs("div",{className:"yearBillDetailItem",children:[e.jsx("span",{children:d.income}),e.jsx("span",{children:"收入"})]}),e.jsxs("div",{className:"yearBillDetailItem",children:[e.jsx("span",{children:d.total}),e.jsx("span",{children:"结余"})]})]}),e.jsx(v,{className:"kaDate",title:"记账日期",precision:"year",visible:x,onCancel:()=>c(!1),onConfirm:s=>{Y(s)},onClose:()=>c(!1),max:new Date})]}),e.jsx("div",{className:"yearBillContent",children:p.keys.length>0&&p.keys.map(s=>e.jsx(b,{date:s,billList:p.groupMonth[s]},s))})]})};export{I as default};
