import{R as x,r as c,d as w,m as g,w as S,c as y,e as E,g as F,h as H,j as s,i as T}from"./index-BkFRGIjD.js";import{C as I,i as B,B as b}from"./button-BdChhM_H.js";import{u as Y,b as K,d as h,H as L,I as D,D as M,a as P}from"./index-DyNBUTRF.js";import{u as R}from"./use-props-value-8KDK95xI.js";import"./attach-properties-to-component-CxYBDbn1.js";function _({onEnterPress:r,onKeyDown:i,nativeInputRef:l,enterKeyHint:o}){const e=n=>{r&&(n.code==="Enter"||n.keyCode===13)&&r(n),i==null||i(n)};return Y(()=>{const n=l.current;if(!(!o||!n))return n.setAttribute("enterkeyhint",o),()=>{n.removeAttribute("enterkeyhint")}},[o]),e}const f="adm-input",V={defaultValue:"",clearIcon:x.createElement(I,null),onlyShowClearWhenFocus:!0},$=c.forwardRef((r,i)=>{const{locale:l,input:o={}}=w(),e=g(V,o,r),[n,u]=R(e),[p,v]=c.useState(!1),d=c.useRef(!1),m=c.useRef(null),C=_({onEnterPress:e.onEnterPress,onKeyDown:e.onKeyDown,nativeInputRef:m,enterKeyHint:e.enterKeyHint});c.useImperativeHandle(i,()=>({clear:()=>{u("")},focus:()=>{var a;(a=m.current)===null||a===void 0||a.focus()},blur:()=>{var a;(a=m.current)===null||a===void 0||a.blur()},get nativeElement(){return m.current}}));function N(){let a=n;if(e.type==="number"){const t=a&&K(parseFloat(a),e.min,e.max).toString();Number(a)!==Number(t)&&(a=t)}a!==n&&u(a)}const j=!e.clearable||!n||e.readOnly?!1:e.onlyShowClearWhenFocus?p:!0;return S(e,x.createElement("div",{className:y(`${f}`,e.disabled&&`${f}-disabled`)},x.createElement("input",{ref:m,className:`${f}-element`,value:n,onChange:a=>{u(a.target.value)},onFocus:a=>{var t;v(!0),(t=e.onFocus)===null||t===void 0||t.call(e,a)},onBlur:a=>{var t;v(!1),N(),(t=e.onBlur)===null||t===void 0||t.call(e,a)},id:e.id,placeholder:e.placeholder,disabled:e.disabled,readOnly:e.readOnly,maxLength:e.maxLength,minLength:e.minLength,max:e.max,min:e.min,autoComplete:e.autoComplete,enterKeyHint:e.enterKeyHint,autoFocus:e.autoFocus,pattern:e.pattern,inputMode:e.inputMode,type:e.type,name:e.name,autoCapitalize:e.autoCapitalize,autoCorrect:e.autoCorrect,onKeyDown:C,onKeyUp:e.onKeyUp,onCompositionStart:a=>{var t;d.current=!0,(t=e.onCompositionStart)===null||t===void 0||t.call(e,a)},onCompositionEnd:a=>{var t;d.current=!1,(t=e.onCompositionEnd)===null||t===void 0||t.call(e,a)},onClick:e.onClick,step:e.step,role:e.role,"aria-valuenow":e["aria-valuenow"],"aria-valuemax":e["aria-valuemax"],"aria-valuemin":e["aria-valuemin"],"aria-label":e["aria-label"]}),j&&x.createElement("div",{className:`${f}-clear`,onMouseDown:a=>{a.preventDefault()},onClick:()=>{var a,t;u(""),(a=e.onClear)===null||a===void 0||a.call(e),B()&&d.current&&(d.current=!1,(t=m.current)===null||t===void 0||t.blur())},"aria-label":l.Input.clear},e.clearIcon)))});var k={exports:{}};(function(r,i){(function(l,o){r.exports=o()})(E,function(){return function(l,o,e){o.prototype.isToday=function(){var n="YYYY-MM-DD",u=e();return this.format(n)===u.format(n)}}})})(k);var A=k.exports;const O=F(A);h.extend(O);const W=()=>{const[r,i]=c.useState(new Date),[l,o]=c.useState(!1),e=h(r),n=e.isToday()?"今天":e.format("YYYY/MM/DD");return{date:e,dateText:n,visible:l,onShowDate:()=>o(!0),onHideDate:()=>o(!1),onDateChange:d=>i(d)}},Q=()=>{const[r,i]=c.useState(""),[l,o]=c.useState("pay"),[e,n]=c.useState(""),{visible:u,dateText:p,onShowDate:v,onHideDate:d,onDateChange:m}=W(),C=H(),N=a=>{i(a)},j=()=>{const a={type:l,money:l==="pay"?-r:+r,date:p==="今天"?h():h(`${p} ${h().format("HH:mm:ss")}`),useFor:e};C(T(a))};return s.jsxs("div",{className:"keepAccount",children:[s.jsx("div",{className:"header-wrap",children:s.jsx(L,{className:"nav",backArrow:!0,title:"记一笔"})}),s.jsxs("div",{className:"header",children:[s.jsxs("div",{className:"kaType",children:[s.jsx(b,{shape:"rounded",className:y(l==="pay"?"selected":""),onClick:()=>{o("pay")},children:"支出"}),s.jsx(b,{className:y(l==="income"?"selected":""),shape:"rounded",onClick:()=>{o("income")},children:"收入"})]}),s.jsx("div",{className:"kaFormWrapper",children:s.jsxs("div",{className:"kaForm",children:[s.jsxs("div",{className:"date",onClick:v,children:[s.jsx(D,{type:"calender",className:"icon"}),s.jsx("span",{className:"text",children:p}),s.jsx(M,{className:"kaDate",title:"记账日期",visible:u,onClose:d,max:new Date,onConfirm:m})]}),s.jsxs("div",{className:"kaInput",children:[s.jsx($,{className:"input",placeholder:"0.00",type:"number",value:r,onChange:N}),s.jsx("span",{className:"iconYuan",children:"¥"})]})]})})]}),s.jsx("div",{className:"kaTypeList",children:P[l].map(a=>s.jsxs("div",{className:"kaType",children:[s.jsx("div",{className:"title",children:a.name}),s.jsx("div",{className:"list",children:a.list.map(t=>s.jsxs("div",{className:y("item",e===t.type?"selected":""),onClick:()=>n(t.type),children:[s.jsx("div",{className:"icon",children:s.jsx(D,{type:t.type})}),s.jsx("div",{className:"text",children:t.name})]},t.type))})]},a.type))}),s.jsx("div",{className:"btns",children:s.jsx(b,{className:"btn save",onClick:j,children:"保 存"})})]})};export{Q as default};
