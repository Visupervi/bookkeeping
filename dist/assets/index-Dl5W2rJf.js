import{r as n,k as Y,j as e,c as M}from"./index-BkFRGIjD.js";import{_ as j,S as N}from"./index-Ce7Rww7O.js";import{d as c,H as k,D as v}from"./index-DyNBUTRF.js";import"./attach-properties-to-component-CxYBDbn1.js";import"./use-props-value-8KDK95xI.js";const I=()=>{const[u,r]=n.useState(!1),[l,f]=n.useState(()=>c(new Date).format("YYYY-MM")),[o,m]=n.useState([]),{billList:x}=Y(s=>s.bill),i=n.useMemo(()=>j.groupBy(x,s=>c(s.date).format("YYYY-MM")),[x]),d=n.useMemo(()=>{const s=o.filter(t=>t.type==="pay").reduce((t,h)=>t+h.money,0),a=o.filter(t=>t.type==="income").reduce((t,h)=>t+h.money,0);return{pay:s,income:a,total:s+a}},[o,l]),p=n.useMemo(()=>{const s=j.groupBy(o,t=>c(t.date).format("YYYY-MM-DD")),a=Object.keys(s);return{groupDay:s,keys:a}},[o,l]),y=()=>{r(!0)},D=s=>{const a=c(s).format("YYYY-MM");f(a),i[a]?m(i[a]):m([]),r(!1)};return n.useEffect(()=>{i[l]&&m(i[l])},[i]),e.jsxs("div",{className:"monthBill",children:[e.jsx(k,{title:"月度账单",backArrow:!1}),e.jsxs("div",{className:"monthContent",children:[e.jsxs("div",{className:"monthBillTitle",children:[e.jsxs("span",{children:[l.split("-")[0]," | ",l.split("-")[1],"月账单"]}),e.jsx("div",{className:"billIconWrap",children:e.jsx("span",{className:M("billIcon",u&&"expand"),onClick:y})})]}),e.jsxs("div",{className:"monthBillDetail",children:[e.jsxs("div",{className:"monthBillDetailItem",children:[e.jsx("span",{children:d.pay.toFixed(2)}),e.jsx("span",{children:"支出"})]}),e.jsxs("div",{className:"monthBillDetailItem",children:[e.jsx("span",{children:d.income.toFixed(2)}),e.jsx("span",{children:"收入"})]}),e.jsxs("div",{className:"monthBillDetailItem",children:[e.jsx("span",{children:d.total.toFixed(2)}),e.jsx("span",{children:"结余"})]})]}),e.jsx(v,{className:"kaDate",title:"记账日期",precision:"month",visible:u,onCancel:()=>r(!1),onConfirm:s=>{D(s)},onClose:()=>r(!1),max:new Date})]}),e.jsx("div",{className:"dayBillContent",children:p.keys.length>0&&p.keys.map(s=>e.jsx(N,{date:s,billList:p.groupDay[s]},s))})]})};export{I as default};
